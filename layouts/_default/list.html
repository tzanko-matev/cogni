{{ define "main" }}
  <div class="page-intro">
    {{ partial "breadcrumbs.html" . }}
    <h1>{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }}{{ end }}</h1>
    {{ with .Content }}
      <div class="prose">{{ . }}</div>
    {{ end }}
  </div>

  {{ $sections := .Sections }}
  {{ $regular := .RegularPages }}

  {{ if $sections }}
    <section class="grid-block">
      <h2>Sections</h2>
      <div class="grid">
        {{ range $sections.ByTitle }}
          <a class="card" href="{{ .RelPermalink }}">
            <h3>{{ .Title }}</h3>
            <p class="meta">{{ .RelPermalink }}</p>
          </a>
        {{ end }}
      </div>
    </section>
  {{ end }}

  {{ if $regular }}
    <section class="grid-block">
      <h2>Docs</h2>
      <div class="grid">
        {{ range $regular.ByTitle }}
          <a class="card" href="{{ .RelPermalink }}">
            <h3>{{ .Title }}</h3>
            {{ with .File.Path }}
              <p class="meta">{{ . }}</p>
            {{ end }}
          </a>
        {{ end }}
      </div>
    </section>
  {{ end }}

  {{ if and (eq (len $sections) 0) (eq (len $regular) 0) (gt (len .RegularPagesRecursive) 0) }}
    <section class="grid-block">
      <h2>Docs</h2>
      <div class="grid">
        {{ range .RegularPagesRecursive.ByTitle }}
          <a class="card" href="{{ .RelPermalink }}">
            <h3>{{ .Title }}</h3>
            {{ with .File.Path }}
              <p class="meta">{{ . }}</p>
            {{ end }}
          </a>
        {{ end }}
      </div>
    </section>
  {{ end }}
{{ end }}
